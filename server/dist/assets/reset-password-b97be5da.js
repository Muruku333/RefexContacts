import{b as W,q,r as t,a as j,j as e,W as A,B as f,af as F,d as E,ag as G,T as r,I as w,L as U,ai as V,ah as $,s as z}from"./index-d1aa6ff3.js";import{I as y}from"./iconify-43ca2dfd.js";import{C as D}from"./Card-5f6b9976.js";import{T as P}from"./TextField-c2cffd25.js";import{I as v}from"./InputAdornment-e1ff2afe.js";import{L as H}from"./LoadingButton-daf6b431.js";import{B as M}from"./Button-4b98d499.js";import"./Select-ce817718.js";import"./Menu-ab006b31.js";import"./isMuiElement-97e72d0b.js";const C=z("div")(({theme:i})=>({maxWidth:"auto",margin:"auto",minHeight:"100vh",display:"flex",justifyContent:"center",flexDirection:"column",padding:i.spacing(12,0)}));function te(){const{token:i}=W(),d=q(),[S,c]=t.useState(!1),[b,T]=t.useState({email:null}),[h,k]=t.useState(""),[g,I]=t.useState(""),[m,L]=t.useState(!1),[u,_]=t.useState(!1),[l,p]=t.useState(!1),[x,a]=t.useState(""),[B,o]=t.useState(!1);t.useEffect(()=>{try{j.post(`/api/verify_token/${i}`).then(s=>{s.data.status&&(c(!0),T(s.data.results.user))}).catch(s=>{c(!1),console.log(s),a(s.response.data.message)})}catch{c(!1),a("Unexpected error occurred!")}},[i]);const R=s=>{if(o(!0),a(""),s.preventDefault(),!h)setTimeout(()=>{a("Password is required."),o(!1)},1e3);else if(!g)setTimeout(()=>{a("Confirm Password is required."),o(!1)},1e3);else try{j.patch(`/api/reset_password/${i}`,{password:h,confirm_password:g}).then(n=>{n.data.status&&setTimeout(()=>{p(!0),o(!1),a(n.data.message)},1e3)}).catch(n=>{setTimeout(()=>{p(!1),o(!1),a(n.response.data.message)},1e3)})}catch(n){p(!1),o(!1),a(n.response.data.message)}};return e.jsxs(e.Fragment,{children:[e.jsx(A,{children:e.jsx("title",{children:" Reset Password | Refex Contacts "})}),e.jsxs(f,{sx:{...F({color:E(d.palette.background.default,.9),imgUrl:"/assets/background/overlay_4.jpg"}),height:1},children:[e.jsx(G,{sx:{position:"fixed",top:{xs:16,md:24},left:{xs:16,md:24}}}),S?e.jsx(C,{sx:{textAlign:"center",alignItems:"center"},children:e.jsxs(D,{sx:{p:3},children:[e.jsx(r,{variant:"h3",color:l?"text.success":"inherit",paragraph:!0,children:l?x:"Reset your password!"}),!l&&e.jsxs(e.Fragment,{children:[e.jsxs(r,{sx:{color:"text.secondary"},children:["Please provide a new password for user ",e.jsx(r,{display:"inline",sx:{color:"text.primary"},children:b.email})]}),e.jsxs(f,{component:"form",noValidate:!0,onSubmit:R,sx:{my:2},children:[e.jsx(P,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:m?"text":"password",id:"password",autoComplete:"current-password",onChange:s=>k(s.target.value),InputProps:{endAdornment:e.jsx(v,{position:"end",children:e.jsx(w,{onClick:()=>L(!m),edge:"end",children:e.jsx(y,{icon:m?"eva:eye-fill":"eva:eye-off-fill"})})})}}),e.jsx(P,{margin:"normal",required:!0,fullWidth:!0,name:"confirm_password",label:"Confirm Password",type:u?"text":"password",id:"confirm_password",autoComplete:"current-password",onChange:s=>I(s.target.value),InputProps:{endAdornment:e.jsx(v,{position:"end",children:e.jsx(w,{onClick:()=>_(!u),edge:"end",children:e.jsx(y,{icon:u?"eva:eye-fill":"eva:eye-off-fill"})})})}}),e.jsx(H,{fullWidth:!0,loading:B,size:"large",type:"submit",variant:"contained",sx:{mt:3,mb:1},children:"Reset Password"}),e.jsx(r,{mt:1,variant:"subtitle1",color:l?d.palette.success.main:d.palette.error.main,align:"center",children:x})]})]}),e.jsx(r,{variant:"subtitle1",display:"inline-block",color:"info",sx:{fontWeight:900},children:e.jsx(U,{href:"/login",underline:"hover",children:"Go To Login Page"})})]})}):e.jsxs(C,{sx:{textAlign:"center",alignItems:"center"},children:[e.jsx(r,{variant:"h3",paragraph:!0,children:x}),e.jsx(r,{sx:{color:"text.secondary"},children:"Sorry, we couldnâ€™t load the password reset form."}),e.jsx(f,{component:"img",src:"/assets/illustrations/illustration_404.svg",sx:{height:260,mx:"auto",my:{xs:4,sm:6}}}),e.jsx(M,{to:"/login",size:"large",variant:"contained",component:V,children:"Go To Login Page"})]}),e.jsx($,{})]})]})}export{te as default};
